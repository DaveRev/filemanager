(function(a){a(["underscore","backbone"],function(a,b){var c=a.extend({collections:[],_callback:function(a){this.off(c.events,c._callback),c.syncDirs(this,a),this.on(c.events,c._callback)},events:"update delete moved filedelete",syncDirs:function(b,d){a.each(this.collections,function(e){var f,g=d.get("path"),h;e!==b&&(h=a.indexOf(e.pluck("path"),g),f=h>=0?e.models[a.indexOf(e.pluck("path"),g)]:null,f&&(e.off(c.events,c._callback),e.updateDir(f,{silent:!1}).always(function(){e.on(c.events,c._callback)})))})},add:function(d){if(a.isArray(d)){a.each(d,a.bind(c.add,c));return this}if(d instanceof b.Collection){this.collections.push(d),this.trigger("add",d,this);return this}throw"can't add none collection Objects"},removeCollection:function(b){if(a.isArray(b)){a.each(b,a.bind(c.removeCollection,c));return this}var d=a.indexOf(this.collections,b);d>=0&&this.collection.splice(d,1);return this}},b.Events);return c})})(this.define)
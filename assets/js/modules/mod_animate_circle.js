(function(a,b){var c=Math.PI,d=c*2,e=c/2;b(["jquery","underscore"],function(a,b){function k(a){this.settings=b.extend(b.clone(k.defaults),a||{}),this.canvas=this.settings.canvas,this.ctx=this.canvas.getContext("2d"),this._begin=-e,this._cw=this.canvas.width,this._ch=this.canvas.height,this._last=[0],this._ao=jQuery({p:0}),this._calcColDiff(),this.ctx.arc(this._cw/2,this._ch/2,this._ch/2-this.settings.lineWidth,0,d,!1);var c=this._ch/2,f=c-this.settings.lineWidth;this._grad=this.ctx.createRadialGradient(c,c,f,c,c,c),j.call(this,[220,220,220]),this.ctx.beginPath(),this.ctx.lineWidth=this.settings.lineWidth,this.ctx.strokeStyle=this._grad,this.ctx.closePath(),this.ctx.fill(),this.ctx.arc(this._cw/2,this._ch/2,this._ch/2-this.settings.lineWidth/2,-e,100-e,!1),this.ctx.stroke(),this._imd=this.ctx.getImageData(0,0,this._cw,this._ch)}function j(a){var b=this._ch/2,c=b-this.settings.lineWidth;this._grad=this.ctx.createRadialGradient(b,b,c,b,b,b),this._grad.addColorStop(0,i(g(a,10))),this._grad.addColorStop(.3,i(a)),this._grad.addColorStop(.7,i(a)),this._grad.addColorStop(1,i(g(a,10)))}function i(a){var b=a.length>3?"rgba(":"rgb(";return b+a.join(",")+")"}function h(a,b){var c=a[0],d=a[1],e=a[2],g=f(b,c),h=f(b,d),i=f(b,e);return[g,h,i]}function g(a,b){var d=a[0],e=a[1],f=a[2],g=c(b,d),h=c(b,e),i=c(b,f);return[g,h,i]}function f(a,b){return Math.min(Math.round((b/255*100+a)/100*255),255)}function c(a,b){return Math.max(Math.round((b/255*100-a)/100*255),0)}k.prototype={_prop:function(a){return{p:a}},_complete:function(a){typeof a=="function"&&setTimeout(a,0)},drawFullCircle:function(a){j.call(this,a),this.ctx.putImageData(this._imd,0,0),this.ctx.strokeStyle=this._grad,this.ctx.arc(this._cw/2,this._ch/2,this._ch/2-this.settings.lineWidth/2,-e,100-e,!1),this.ctx.stroke(),this.ctx.closePath()},clearAnimation:function(){this._ao.stop(),this._ao.dequeue()},animate:function(a,c){this._ao[0].p=this._last.pop()||0,this._ao.stop().animate(this._last.push(a)&&this._prop(a),{duration:this.settings.stepTime,step:b.bind(this._step,this),complete:b.bind(this._complete,this,c)})},_step:function(a){var b=d/100*a;this._draw(b,this._getCurrentColor(a))},_draw:function(a,b){if(a!==0&&a===this._begin||a>=d){this.clearAnimation();return!1}j.call(this,this._cCol),this.ctx.putImageData(this._imd,0,0),this.ctx.beginPath(),this.ctx.strokeStyle=this._grad,this.ctx.arc(this._cw/2,this._ch/2,this._ch/2-this.settings.lineWidth/2,-e,a-e,!1),this.ctx.stroke()},_calcColDiff:function(){var a=this.settings.startColor,b=this.settings.endColor;this._colDiff=a,this._cMatrix=[],this._cCol=[],this._cMatrix[0]=(b[0]-a[0])/100,this._cMatrix[1]=(b[1]-a[1])/100,this._cMatrix[2]=(b[2]-a[2])/100},_getCurrentColor:function(a){this._cCol[0]=Math.round(this._colDiff[0]+this._cMatrix[0]*a),this._cCol[1]=Math.round(this._colDiff[1]+this._cMatrix[1]*a),this._cCol[2]=Math.round(this._colDiff[2]+this._cMatrix[2]*a);return"rgb("+this._cCol.join(",")+")"},update:function(){}},k.defaults={canvas:document.createElement("canvas"),startColor:[89,123,198],endColor:[126,222,79],background:"rgb(250, 250, 250)",stepTime:250,lineWidth:5};return k})})(this,this.define)
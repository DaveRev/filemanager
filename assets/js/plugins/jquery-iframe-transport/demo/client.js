(function(a){function b(a){var b=["B","KB","MB","GB"],c=0;while(a>=1024)a/=1024,c++;return a.toFixed(0)+" "+b[c]}a("form").on("change",":file",function(){var c=a(this.form).addClass("loading");a.ajax(c.prop("action"),{files:c.find(":file"),iframe:!0,dataType:"json"}).always(function(){c.removeClass("loading")}).done(function(d){a.each(d.files,function(c,d){a("<li><b></b> (<span class='size'></span>, <span class='mime'></span>)</li>").find("b").text(d.filename).end().find(".size").text(b(d.length)).end().find(".mime").text(d.mime).end().appendTo("#filelist")}),c.find(":file").val("")})})})(jQuery)